{% extends 'base.html' %}
{% load static %}

{% block title %}{{ action }} Medication - ShareMyCare{% endblock %}

{% block content %}
<div class="form-container">
    <div class="form-card">
        <div class="form-header">
            <h1 class="form-title">{{ action }} Medication</h1>
            <a href="{% url 'health_records:dashboard' %}" class="btn-close">âœ•</a>
        </div>
        
        <form method="post" class="form" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="{{ form.name.id_for_label }}">Medication Name *</label>
                {{ form.name }}
                {% if form.name.errors %}
                    <span class="field-error">{{ form.name.errors.0 }}</span>
                {% endif %}
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="{{ form.dosage.id_for_label }}">Dosage</label>
                    {{ form.dosage }}
                </div>
                <div class="form-group">
                    <label for="{{ form.frequency.id_for_label }}">Frequency</label>
                    {{ form.frequency }}
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="{{ form.start_date.id_for_label }}">Start Date</label>
                    {{ form.start_date }}
                </div>
                <div class="form-group">
                    <label for="{{ form.end_date.id_for_label }}">End Date</label>
                    {{ form.end_date }}
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group checkbox-group">
                    {{ form.is_prescribed }}
                    <label for="{{ form.is_prescribed.id_for_label }}">Prescribed by healthcare provider</label>
                </div>
                <div class="form-group checkbox-group">
                    {{ form.is_active }}
                    <label for="{{ form.is_active.id_for_label }}">Currently Active</label>
                </div>
            </div>
            
            <div class="form-group">
                <label for="{{ form.prescribing_clinician.id_for_label }}">Prescribing Clinician</label>
                {{ form.prescribing_clinician }}
            </div>
            
            <div class="form-group">
                <label for="{{ form.prescription_image.id_for_label }}">Prescription Photo</label>
                <div class="file-upload-wrapper">
                    <input type="file" name="{{ form.prescription_image.name }}" id="{{ form.prescription_image.id_for_label }}" class="form-file-input" accept="image/*" capture="environment">
                    <label for="{{ form.prescription_image.id_for_label }}" class="file-upload-label">
                        <span class="file-upload-text">ðŸ“· Take Photo or Choose Image</span>
                    </label>
                </div>
                {% if medication and medication.prescription_image %}
                    <div class="current-image">
                        <p class="current-image-label">Current prescription:</p>
                        <img src="{{ medication.prescription_image.url }}" alt="Prescription" class="prescription-preview">
                        <p class="image-hint">Upload a new image to replace this one</p>
                    </div>
                {% endif %}
                <p class="form-hint">You can take a photo with your device or upload an existing image</p>
            </div>
            
            <div class="form-group">
                <label for="{{ form.notes.id_for_label }}">Notes</label>
                {{ form.notes }}
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Save Medication</button>
                <a href="{% url 'health_records:dashboard' %}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

